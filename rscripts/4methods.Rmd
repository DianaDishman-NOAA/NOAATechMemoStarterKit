---
title: ""
author: ""
date: ""
output: 
   word_document:
     df_print: kable
     reference_docx: word-styles-reference.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, error = FALSE)
```

### Methods

Here is the report methodology!


```{r ChunkName_NameMeAnythingAsLongAsItIsUnique}
#Chunks are were we can write code for something later in the code. 
```

## Example Figure

```{r G1a}
# Don't Edit This:
cnt.chapt.content<-auto_counter(cnt.chapt.content)
cnt.figures<-auto_counter(cnt.figures)
```


```{r G1b}
# Edit This:
THeader<-paste0("Figure ",cnt.figures,". Here's a plot")
TFootnotes<-"A footnote for this figure!"

# Select data and make plot
dat1<-dat[dat$YEAR %in% 2017,]
plot<-qplot(dat1$LATITUDE, dat1$LONGITUDE, col = as.factor(dat1$VESSEL)) # create plot
```


```{r G1c}
# Don't Edit This:
THeader<-simpleCap(THeader)
Title0<-paste0(THeader, TFootnotes)

if (designflowin %in% T){
  counter<-funct_counter(counter)
  rmarkdown::render(TableFigureHeader, 
                    quiet = T,
                  output_dir = dir.chapters, 
                  output_file = paste0(filename00,"_Title.docx"))
}
```

#### `r ifelse(designflowin %in% T, "", Title0)` 

```{r G1d}
# Don't Edit This:

# Systematically save your plot with this simple function
SaveGraphs(plot, filename0, cnt.chapt.content, cnt.figures, 
           path = dir.chapters, 
           width = 6, height = 6)

# Print or Don't Print Plot in Text
# You don't want to print this in the document if this text will be flowed into InDesign. 
# However, sometimes its nice to see everything all together, so this variable is something you might like to toggle on and off. Hense, FALSE = print here, TRUE = don't print here, just make the .pdf (coded above)
if (designflowin %in% F) { 
  plot #print plot in text
}
```

## Example Table

```{r T1a}
# Don't Edit This:
cnt.chapt.content<-auto_counter(cnt.chapt.content)
cnt.tables<-auto_counter(cnt.tables)
```

```{r T1b, echo=FALSE, warning=FALSE, message=FALSE}
# Edit This:

TFootnotes<-"Here is a Footnote for this table"# Footnote
THeader = paste0("Table ",cnt.tables,". Here's a table")

# Select data for table
# Make a table of content, but don't edit your content. This is just good record keeping so peolpe can check your work. 
table.raw<-dat[dat$YEAR %in% 2017,
          c("LATITUDE", "LONGITUDE", "VESSEL")]

names(table.raw)<-firstup(tolower(names(table.raw)))

table.raw<-dplyr::rename(table.raw, 
                         "Vessel ID Number" = "VESSEL")

# Make the table pretty, like as you would have it show in the report. 
table.print<- table.raw %>% 
  mutate_at(vars(Latitude, Longitude), 
            funs(round(., 1)))
```


```{r T1c}
# Don't Edit This:

Title0<-paste0(THeader, TFootnotes)
filename00<-paste0(filename0, "_", counter, "_Figure_",cnt.figures)

if (designflowin %in% T){
  counter<-funct_counter(counter)
  rmarkdown::render(TableFigureHeader, 
                    quiet = T,
                  output_dir = dir.chapters, 
                  output_file = paste0(filename00,"_Title.docx"))
}
```

#### `r ifelse(designflowin %in% T, "", Title0)` 

```{r T1d}
# Don't Edit This:

# Systematically save your plot with this simple function
SaveTables(table.raw, table.print, THeader, TFootnotes, 
                     filename00, 
                     dir.chapters, dir.outputtables,
                     cnt.chapt.content, cnt.tables)

# Print or Don't Print Table in Text
# You don't want to print this in the document if this text will be flowed into InDesign. 
# However, sometimes its nice to see everything all together, so this variable is something you might like to toggle on and off. Hense, FALSE = print here, TRUE = don't print here, just make the .pdf (coded above)
if (designflowin %in% F) {
  
  # names(b)<-paste0("**", names(b), "**") #Bold your table column names
  # names(b)[names(b) %in% "****"]<-"" #But don't bold where there is no column name
  
  print(b %>%
          format_cells(rows = 0, # make column names
                       cols = 1:ncol(b), # for all columns
                       fonttype = "bold") %>% # bold
          knitr::kable(row.names = F, booktabs = T)) #print table in text
}
```

